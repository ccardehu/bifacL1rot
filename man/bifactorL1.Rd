% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{bifactorL1}
\alias{bifactorL1}
\title{L1 rotation for Generalized Bi-factor Models}
\usage{
bifactorL1(
  A,
  Bstart = NULL,
  Phi = NULL,
  rho = 1,
  t = 1/1000,
  maxit.ou = 5000,
  maxit.in = 300,
  orthogonal = FALSE,
  tol1 = 1e-06,
  tol2 = 1e-04,
  verbose = TRUE,
  v.every = 10,
  Lmax = 20,
  c1 = 1.05,
  c2 = 0.25
)
}
\arguments{
\item{A}{Input factor loading matrix (p x q)}

\item{Bstart}{Optional starting value for B matrix. Defaults to A.}

\item{Phi}{Optional starting correlation matrix. Defaults to identity.}

\item{rho}{Initial penalty parameter for augmented Lagrangian method. Default 1.}

\item{t}{Initial step size. Default 1/1000.}

\item{maxit.ou}{Maximum outer iterations. Default 5000.}

\item{maxit.in}{Maximum inner iterations. Default 300.}

\item{orthogonal}{Logical; if TRUE, constrains factors to be orthogonal. Default FALSE.}

\item{tol1}{Convergence tolerance for parameter changes. Default 1e-6.}

\item{tol2}{Tolerance for backtracking line search. Default 1e-4.}

\item{verbose}{Logical; print progress. Default TRUE.}

\item{v.every}{Print frequency (every v.every outer iterations). Default 10.}

\item{Lmax}{Clipping bound for Lagrange multipliers. Default 20.}

\item{c1}{Multiplicative factor for rho increase (must be > 1). Default 1.05.}

\item{c2}{Threshold for rho update (must be in (0,1)). Default 0.25.}
}
\value{
A list containing:
\itemize{
\item \code{B} - Estimated factor loading matrix (follows a bi-factor structure)
\item \code{Phi} - Estimated factor correlation matrix (follows a bi-factor structure)
\item \code{rho.end} - Final value of rho
\item \code{conv} - Logical; TRUE if converged before maxit.ou
}
}
\description{
L1 rotation for Generalized Bi-factor Models
}
\examples{
\dontrun{
set.seed(1234)
A <- matrix(0, 20, 4) # A 20 x 4 Factor loading matrix
A[,1] = runif(20, 1, 2) # Bi-factor structure, first factor
A[,2] = runif(20, 0.5, 1) * rbinom(20, 1, 0.25)
A[,3] = runif(20, 0.5, 1) * rbinom(20, 1, 0.25)
A[,4] = runif(20, 0.5, 1) * rbinom(20, 1, 0.25)

# Create rotation matrix (via random matrix):
Ah =  array(rnorm(length(A), sd = .5), dim = dim(A))
Tr = eigen(t(Ah) \%*\% Ah)$vectors
Ah = (A)\%*\%(Tr)
res = bifacL1rot::bifactorL1(Ah)
Arot = res$B
Phi = res$Phi
}

}
